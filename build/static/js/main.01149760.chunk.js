(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{114:function(t,e,i){},115:function(t,e,i){"use strict";i.r(e);var n=i(0),s=i.n(n),a=i(6),r=i(13),o=i(11),c=i(43),h=i(38),l=i(42);function u(t,e,i){return{x:(t.x-e.x)*Math.cos(i)-(t.y-e.y)*Math.sin(i)+e.x,y:(t.x-e.x)*Math.sin(i)+(t.y-e.y)*Math.cos(i)+e.y}}function d(t,e){return Math.random()*(e-t+1)+t}function p(t,e,i,n){for(var s=d(t,e);s>i&&s<n;)s=Math.random()*(e-t+1)+t;return s}var f=function(){function t(e){Object(r.a)(this,t);var i=u({x:0,y:-20},{x:0,y:0},e.ship.rotation*Math.PI/180);this.position={x:e.ship.position.x+i.x,y:e.ship.position.y+i.y},this.rotation=e.ship.rotation,this.velocity={x:i.x/2,y:i.y/2},this.radius=2}return Object(o.a)(t,[{key:"destroy",value:function(){this.delete=!0}},{key:"render",value:function(t){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,(this.position.x<0||this.position.y<0||this.position.x>t.screen.width||this.position.y>t.screen.height)&&this.destroy();var e=t.context;e.save(),e.translate(this.position.x,this.position.y),e.rotate(this.rotation*Math.PI/180),e.fillStyle="rgb(58, 58, 58)",e.lineWidth=.5,e.beginPath(),e.arc(0,0,2,0,2*Math.PI),e.closePath(),e.fill(),e.restore()}}]),t}(),v=function(){function t(e){Object(r.a)(this,t),this.position=e.position,this.velocity=e.velocity,this.radius=e.size,this.lifeSpan=e.lifeSpan,this.inertia=.98}return Object(o.a)(t,[{key:"destroy",value:function(){this.delete=!0}},{key:"render",value:function(t){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.velocity.x*=this.inertia,this.velocity.y*=this.inertia,this.radius-=.1,this.radius<.1&&(this.radius=.1),this.lifeSpan--<0&&this.destroy();var e=t.context;e.save(),e.translate(this.position.x,this.position.y),e.fillStyle="#e34840",e.lineWidth=2,e.beginPath(),e.moveTo(0,-this.radius),e.arc(0,0,this.radius,0,2*Math.PI),e.closePath(),e.fill(),e.restore()}}]),t}(),y=function(){function t(e){Object(r.a)(this,t),this.position=e.position,this.velocity={x:0,y:0},this.rotation=0,this.rotationSpeed=6,this.speed=.15,this.inertia=.99,this.radius=20,this.lastShot=0,this.create=e.create,this.onDie=e.onDie}return Object(o.a)(t,[{key:"destroy",value:function(){this.delete=!0,this.onDie();for(var t=0;t<60;t++){var e=new v({lifeSpan:d(60,100),size:d(1,4),position:{x:this.position.x+d(-this.radius/4,this.radius/4),y:this.position.y+d(-this.radius/4,this.radius/4)},velocity:{x:d(-1.5,1.5),y:d(-1.5,1.5)}});this.create(e,"particles")}}},{key:"rotate",value:function(t){"LEFT"==t&&(this.rotation-=this.rotationSpeed),"RIGHT"==t&&(this.rotation+=this.rotationSpeed)}},{key:"accelerate",value:function(t){var e=u({x:0,y:-10},{x:0,y:0},(this.rotation-180)*Math.PI/180),i=new v({lifeSpan:d(20,40),size:d(1,3),position:{x:this.position.x+e.x+d(-2,2),y:this.position.y+e.y+d(-2,2)},velocity:{x:e.x/d(3,5),y:e.y/d(3,5)}});this.create(i,"particles")}},{key:"render",value:function(t){if(t.keys.space&&Date.now()-this.lastShot>300){var e=new f({ship:this});this.create(e,"bullets"),this.lastShot=Date.now()}this.rotation>=360&&(this.rotation-=360),this.rotation<0&&(this.rotation+=360),this.position.x>t.screen.width?this.position.x=0:this.position.x<0&&(this.position.x=t.screen.width),this.position.y>t.screen.height?this.position.y=0:this.position.y<0&&(this.position.y=t.screen.height);var i=t.context;i.save(),i.translate(this.position.x,this.position.y),i.rotate(this.rotation*Math.PI/180),i.strokeStyle="rgb(58, 58, 58)",i.fillStyle="rgb(58, 58, 58)",i.lineWidth=2,i.beginPath(),i.moveTo(0,-15),i.lineTo(10,10),i.lineTo(5,7),i.lineTo(-5,7),i.lineTo(-10,10),i.closePath(),i.fill(),i.stroke(),i.restore()}}]),t}(),m=function(){function t(e){Object(r.a)(this,t),this.position=e.position,this.velocity={x:d(-1.5,3),y:d(-1.5,3)},this.rotation=0,this.rotationSpeed=d(-1,1),this.radius=e.size,this.score=40/this.radius*5,this.create=e.create,this.addScore=e.addScore,this.vertices=function(t,e){for(var i=[],n=0;n<t;n++)i[n]={x:(-Math.sin(360/t*n*Math.PI/180)+Math.round(2*Math.random()-1)*Math.random()/3)*e,y:(-Math.cos(360/t*n*Math.PI/180)+Math.round(2*Math.random()-1)*Math.random()/3)*e};return i}(8,e.size)}return Object(o.a)(t,[{key:"destroy",value:function(){this.delete=!0,this.addScore(this.score);for(var e=0;e<this.radius;e++){var i=new v({lifeSpan:d(60,100),size:d(1,3),position:{x:this.position.x+d(-this.radius/4,this.radius/4),y:this.position.y+d(-this.radius/4,this.radius/4)},velocity:{x:d(-1.5,1.5),y:d(-1.5,1.5)}});this.create(i,"particles")}if(this.radius>10)for(var n=0;n<2;n++){var s=new t({size:this.radius/2,position:{x:d(-10,20)+this.position.x,y:d(-10,20)+this.position.y},create:this.create.bind(this),addScore:this.addScore.bind(this)});this.create(s,"asteroids")}}},{key:"render",value:function(t){this.position.x+=this.velocity.x,this.position.y+=this.velocity.y,this.rotation+=this.rotationSpeed,this.rotation>=360&&(this.rotation-=360),this.rotation<0&&(this.rotation+=360),this.position.x>t.screen.width+this.radius?this.position.x=-this.radius:this.position.x<-this.radius&&(this.position.x=t.screen.width+this.radius),this.position.y>t.screen.height+this.radius?this.position.y=-this.radius:this.position.y<-this.radius&&(this.position.y=t.screen.height+this.radius);var e=t.context;e.save(),e.translate(this.position.x,this.position.y),e.rotate(this.rotation*Math.PI/180),e.strokeStyle="rgb(202, 109, 57)",e.lineWidth=2,e.beginPath(),e.moveTo(0,-this.radius);for(var i=1;i<this.vertices.length;i++)e.lineTo(this.vertices[i].x,this.vertices[i].y);e.closePath(),e.stroke(),e.restore()}}]),t}(),g=i(20),x=i.n(g),b=i(28),S=i(29);function w(){var t=Object(b.a)(["\n    width: 140px;\n    height: 40px;\n    margin: 0 auto;\n    border-radius: 5px;\n    background-color: green;\n"]);return w=function(){return t},t}function k(){var t=Object(b.a)(["\n    width: 100vw;\n    height: 100vh;\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    flex-direction: column;\n    margin: 0;\n    padding: 0;\n"]);return k=function(){return t},t}var j=S.a.div(k()),O=(S.a.div(w()),i(25)),E=i(147);i(153),i(155),i(148);var C=i(119),M=function(t){var e=Object(C.a)({root:{background:"linear-gradient(45deg, #FE6B8B 50%, #FF8E53 90%)",border:0,borderRadius:3,boxShadow:"0 3px 5px 2px rgba(255, 105, 135, .3)",color:"white",padding:"0",display:"flex",flexWrap:"wrap",justifyContent:"center",alignContent:"center"}})(),i={startButtonStyle:{fontSize:35}};return s.a.createElement(j,{className:e.root},s.a.createElement(E.a,{style:i.startButtonStyle,onClick:function(){t.setCurrentScreen("game")}},"Start game"),s.a.createElement(E.a,{onClick:function(){return t.setCurrentScreen("leaderboard")},style:i.startButtonStyle},"GAME SCORES"))},P=function(t){function e(t){var i;return Object(r.a)(this,e),(i=Object(c.a)(this,Object(h.a)(e).call(this,t))).state={screen:{width:window.innerWidth,height:window.innerHeight,ratio:window.devicePixelRatio||1},context:null,keys:{left:0,right:0,up:0,down:0,space:0,lpm:0},asteroidCount:3,currentScore:0,topScore:localStorage.topscore||0,inGame:!1},i.ship=[],i.asteroids=[],i.bullets=[],i.particles=[],i}return Object(l.a)(e,t),Object(o.a)(e,[{key:"handleResize",value:function(t,e){this.setState({screen:{width:window.innerWidth,height:window.innerHeight,ratio:window.devicePixelRatio||1}})}},{key:"handleKeys",value:function(t,e){var i=this.state.keys;i.space=t,this.setState({keys:i}),console.log(e)}},{key:"componentDidMount",value:function(){var t=this;window.addEventListener("mousedown",this.handleKeys.bind(this,!0)),window.addEventListener("mouseup",this.handleKeys.bind(this,!1)),window.addEventListener("resize",this.handleResize.bind(this,!1));var e=this.refs.canvas.getContext("2d");this.setState({context:e}),this.startGame(),requestAnimationFrame(function(){t.update()})}},{key:"componentWillUnmount",value:function(){window.removeEventListener("keyup",this.handleKeys),window.removeEventListener("keydown",this.handleKeys),window.removeEventListener("resize",this.handleResize)}},{key:"update",value:function(){var t=this,e=this.state.context;this.state.keys,this.ship[0];if(e.save(),e.scale(this.state.screen.ratio,this.state.screen.ratio),e.fillStyle="#f8f8f8",e.globalAlpha=.4,e.fillRect(0,0,this.state.screen.width,this.state.screen.height),e.globalAlpha=1,!this.asteroids.length){var i=this.state.asteroidCount+1;this.setState({asteroidCount:i}),this.generateAsteroids(i)}this.checkCollisionsWith(this.bullets,this.asteroids),this.checkCollisionsWith(this.ship,this.asteroids),this.updateObjects(this.particles,"particles"),this.updateObjects(this.asteroids,"asteroids"),this.updateObjects(this.bullets,"bullets"),this.updateObjects(this.ship,"ship"),e.restore(),requestAnimationFrame(function(){t.update()})}},{key:"addScore",value:function(t){this.state.inGame&&this.setState({currentScore:this.state.currentScore+t})}},{key:"startGame",value:function(){var t=this;this.setState({inGame:!0,currentScore:0});var e=new y({position:{x:this.state.screen.width/2,y:this.state.screen.height/2},create:this.createObject.bind(this),onDie:this.gameOver.bind(this)});this.createObject(e,"ship"),this.asteroids=[],this.generateAsteroids(this.state.asteroidCount),document.getElementById("gameBoard").addEventListener("mousemove",function(i){var n=t.showCoords(i),s=t.state.screen.width/2,a=t.state.screen.height/2,r=n[0],o=n[1],c=180*Math.atan2(o-a,r-s)/Math.PI;e.rotation=c+90})}},{key:"showCoords",value:function(t){return[t.clientX,t.clientY]}},{key:"gameOver",value:function(){this.setState({inGame:!1}),this.state.currentScore>this.state.topScore&&(this.setState({topScore:this.state.currentScore}),localStorage.topscore=this.state.currentScore),x.a.post("https://pacific-reef-99038.herokuapp.com/api/scores/",{score:this.state.currentScore,userLogin:this.props.currentAgent})}},{key:"generateAsteroids",value:function(t){for(var e=this.ship[0],i=0;i<t;i++){var n=new m({size:40,position:{x:p(0,this.state.screen.width,e.position.x-60,e.position.x+60),y:p(0,this.state.screen.height,e.position.y-60,e.position.y+60)},create:this.createObject.bind(this),addScore:this.addScore.bind(this)});this.createObject(n,"asteroids")}}},{key:"createObject",value:function(t,e){this[e].push(t)}},{key:"updateObjects",value:function(t,e){var i=0,n=!0,s=!1,a=void 0;try{for(var r,o=t[Symbol.iterator]();!(n=(r=o.next()).done);n=!0){r.value.delete?this[e].splice(i,1):t[i].render(this.state),i++}}catch(c){s=!0,a=c}finally{try{n||null==o.return||o.return()}finally{if(s)throw a}}}},{key:"checkCollisionsWith",value:function(t,e){for(var i,n=t.length-1;n>-1;--n)for(i=e.length-1;i>-1;--i){var s=t[n],a=e[i];this.checkCollision(s,a)&&(s.destroy(),a.destroy())}}},{key:"checkCollision",value:function(t,e){var i=t.position.x-e.position.x,n=t.position.y-e.position.y;return Math.sqrt(i*i+n*n)<t.radius+e.radius}},{key:"render",value:function(){var t,e,i=this;return e=this.state.currentScore<=0?"0 points. Sad.":this.state.currentScore>=this.state.topScore?"Top score with "+this.state.currentScore+" points. Woo!":this.state.currentScore+" points look cool. :)",this.state.inGame||(t=s.a.createElement("div",{className:"endgame"},s.a.createElement("p",null,"That's it!"),s.a.createElement("p",null,e),s.a.createElement("button",{onClick:this.startGame.bind(this)},"Try again"),s.a.createElement("button",{onClick:function(){return i.props.setCurrentScreen("start")}},"Home menu"))),s.a.createElement("div",null,t,s.a.createElement("span",{className:"score current-score"},"Score: ",this.state.currentScore),s.a.createElement("div",{className:"controls"},"Use mouse to move"),s.a.createElement("canvas",{id:"gameBoard",ref:"canvas",width:this.state.screen.width*this.state.screen.ratio,height:this.state.screen.height*this.state.screen.ratio}))}}]),e}(n.Component),A=i(41),T=i.n(A),z=i(52),I=i(73),L={server_url:"https://us-central1-livechat-experiments.cloudfunctions.net/restApi",account_url:"https://accounts.livechatinc.com/",client_id:"b9a9ce57595f6814655643cbf9ddaa96"},B=i(150),_=i(151),W=i(154),G=i(152),D=i(149);function R(){var t=Object(b.a)(["\n    width: 100px;\n    height: 40px;\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    background-color: grey;\n"]);return R=function(){return t},t}function F(){var t=Object(b.a)(["\n    width: 100%;\n    height: 40px;\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n"]);return F=function(){return t},t}function K(){var t=Object(b.a)(["\n    width: 100%;\n    height: 40px;\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n"]);return K=function(){return t},t}function N(){var t=Object(b.a)(["\n    width: 100%;\n    height: 40px;\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n"]);return N=function(){return t},t}var H=S.a.div(N()),q=S.a.div(K()),J=(S.a.div(F()),S.a.div(R()));function U(t){return s.a.createElement(D.a,{component:"div",style:{padding:24}},t.children)}var X=Object(B.a)(function(t){return{root:{flexGrow:1,backgroundColor:t.palette.background.paper}}}),V=(s.a.Component,function(t){function e(){var t,i;Object(r.a)(this,e);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(i=Object(c.a)(this,(t=Object(h.a)(e)).call.apply(t,[this].concat(s)))).state={allScores:[]},i}return Object(l.a)(e,t),Object(o.a)(e,[{key:"componentDidMount",value:function(){var t=this;x.a.get("https://pacific-reef-99038.herokuapp.com/api/scores/week").then(function(e){console.log(e.data);var i=e.data;t.setState({allScores:i.sort()})})}},{key:"render",value:function(){var t=this;return s.a.createElement("div",null,this.state.allScores.length>0&&this.props.agents.length>0?s.a.createElement("div",null,s.a.createElement(J,{onClick:function(){t.props.setCurrentScreen("start")}},"Back to menu"),this.state.allScores.map(function(e){return s.a.createElement(q,null,s.a.createElement("img",{src:"http://".concat(t.props.agents.filter(function(t){return t.login===e.userLogin})[0].avatar)}),t.props.agents.filter(function(t){return t.login===e.userLogin})[0].name," - ",e.score)})):"Loading")}}]),e}(s.a.Component)),Y=function(t){function e(){var t,i;Object(r.a)(this,e);for(var n=arguments.length,s=new Array(n),a=0;a<n;a++)s[a]=arguments[a];return(i=Object(c.a)(this,(t=Object(h.a)(e)).call.apply(t,[this].concat(s)))).state={allScores:[]},i}return Object(l.a)(e,t),Object(o.a)(e,[{key:"componentDidMount",value:function(){var t=this;x.a.get("https://pacific-reef-99038.herokuapp.com/api/scores").then(function(e){console.log(e.data);var i=e.data;t.setState({allScores:i.sort()})})}},{key:"render",value:function(){var t=this;return s.a.createElement("div",null,this.state.allScores.length>0&&this.props.agents.length>0?s.a.createElement("div",null,s.a.createElement(J,{onClick:function(){t.props.setCurrentScreen("start")}},"Back to menu"),this.state.allScores.map(function(e){return s.a.createElement(q,null,s.a.createElement("img",{src:"http://".concat(t.props.agents.filter(function(t){return t.login===e.userLogin})[0].avatar)}),t.props.agents.filter(function(t){return t.login===e.userLogin})[0].name," - ",e.score)})):"Loading")}}]),e}(s.a.Component);var Q=function(t){var e=X(),i=s.a.useState(0),a=Object(O.a)(i,2),r=a[0],o=a[1],c=s.a.useState([]),h=Object(O.a)(c,2),l=h[0],u=h[1];return Object(n.useEffect)(Object(z.a)(T.a.mark(function e(){var i;return T.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get("".concat(L.server_url,"/agents/"),{headers:{"X-API-Version":"2",Authorization:"Bearer ".concat(t.accessToken)}});case 2:i=e.sent,u(i.data);case 4:case"end":return e.stop()}},e)})),[t.accessToken]),console.log(l),s.a.createElement("div",{className:e.root},s.a.createElement(_.a,{position:"static"},s.a.createElement(W.a,{value:r,onChange:function(t,e){o(e)}},s.a.createElement(G.a,{label:"Best week scores"}),s.a.createElement(G.a,{label:"All scores"}))),0===r&&s.a.createElement(U,null,s.a.createElement(V,{setCurrentScreen:t.setCurrentScreen,agents:l})),1===r&&s.a.createElement(U,null,s.a.createElement(Y,{setCurrentScreen:t.setCurrentScreen,agents:l})))},Z=function(){var t=Object(n.useState)(null),e=Object(O.a)(t,2),i=e[0],a=e[1],r=Object(n.useState)(null),o=Object(O.a)(r,2),c=o[0],h=o[1],l=Object(n.useState)("start"),u=Object(O.a)(l,2),d=u[0],p=u[1];Object(n.useEffect)(function(){var t=L.client_id,e=L.account_url;I.a.init({client_id:t,onIdentityFetched:function(i,n){n&&n.access_token?(console.log(n),a(n.access_token),h(n.entity_id)):window.location.href="".concat(e,"?response_type=token&client_id=").concat(t,"&redirect_uri=").concat(window.location.href)}})});return s.a.createElement("div",null,"leaderboard"===d?s.a.createElement(Q,{currentAgent:c,setCurrentScreen:p,accessToken:i}):null,"start"===d?s.a.createElement(M,{setCurrentScreen:p}):null,"game"===d?s.a.createElement(P,{setCurrentScreen:p,currentAgent:c}):null)};i(114);Object(a.render)(s.a.createElement(Z,null),document.getElementById("root"))},78:function(t,e,i){t.exports=i(115)}},[[78,1,2]]]);
//# sourceMappingURL=main.01149760.chunk.js.map